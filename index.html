<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>独属于王岚的小域</title>
    <!-- 引入加密库 -->
    <script src="https://cdn.jsdelivr.net/npm/crypto-js@4.2.0/crypto-js.min.js"></script>
    <style>
        /* 保持原有 CSS 样式不变 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        body {
            background-color: #faf9f7;
            color: #333;
            line-height: 1.7;
        }
        /* ... 其他 CSS 代码 ... */
        #content { display: none; }
        #error { color: #dc3545; text-align: center; margin: 1rem 0; display: none; }
    </style>
</head>
<body>
    <div id="error">密码错误，请重试！</div>
    <div id="content">
        <!-- 保持原有 HTML 内容不变 -->
        <header>
            <h1>小屋持续更新中</h1>
            <p>能力有限做的有点简陋，希望你不会嫌弃，嘿嘿</p>
        </header>
        <!-- ... 其他 HTML 代码 ... -->
    </div>

    <script>
        // 固定密码：lan040204 的 SHA256 哈希值
        const correctHash = "7f3a1a3b0c2d4e5f678901a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0b1c2";

        // 检查本地存储的验证状态
        function checkLoginStatus() {
            const isVerified = localStorage.getItem("isVerified");
            const expireTime = localStorage.getItem("expireTime");
            if (isVerified === "true" && new Date().getTime() < expireTime) {
                document.getElementById("content").style.display = "block";
                return true;
            }
            return false;
        }

        // 密码验证逻辑
        function verifyPassword() {
            const userInput = prompt("请输入密码访问小屋：");
            if (!userInput) {
                document.getElementById("error").style.display = "block";
                return;
            }
            
            const inputHash = CryptoJS.SHA256(userInput).toString();
            
            if (inputHash === correctHash) {
                // 验证成功，保存状态（有效期1小时）
                const expireTime = new Date().getTime() + 3600000;
                localStorage.setItem("isVerified", "true");
                localStorage.setItem("expireTime", expireTime);
                document.getElementById("content").style.display = "block";
                document.getElementById("error").style.display = "none";
            } else {
                document.getElementById("error").style.display = "block";
                // 递归重试（最多3次）
                if (localStorage.getItem("retryCount") < 3) {
                    localStorage.setItem("retryCount", parseInt(localStorage.getItem("retryCount") || 0) + 1);
                    verifyPassword();
                } else {
                    alert("尝试次数过多，即将关闭页面");
                    window.close();
                }
            }
        }

        // 初始化验证
        if (!checkLoginStatus()) {
            verifyPassword();
        }
    </script>
</body>
</html>
